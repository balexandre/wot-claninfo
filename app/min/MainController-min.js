!function(){var a=angular.module("wotClanInfo"),l=function(a,l,e,n){l.info("MainController loaded");var r="500046531",s=200,t=function(e){l.error(e),a.error=e},o=function(e){l.info("onClanComplete"),l.debug(e),a.clan=e.data[_.keys(e.data)[0]];for(var r=[],s=0;s<_.keys(a.clan.members).length;s++){var o=_.keys(a.clan.members)[s];r.push(o)}l.debug(r),n.getPlayerTanks(r).then(i,t)},i=function(e){l.info("onTanksComplete"),l.debug(e);for(var r=[],s=0;s<_.keys(a.clan.members).length;s++){var o=_.keys(a.clan.members)[s];a.players.push(o),a.allTanksByPlayerId[o]=e.data[o],a.allTanksByPlayerId2[o]=[];for(var i=0;i<a.allTanksByPlayerId[o].length;i++){var y=a.allTanksByPlayerId[o][i],T=y.tank_id;r.push(T),a.allTanksByPlayerId2[o][T]=y}}var f=_.union(r);l.info("Clan has "+f.length+" unique vehicles"),n.getTank(f.join()).then(k,t)},k=function(e){l.info("onTankInfoComplete"),l.debug(e),a.allTankInfos=[];for(var n=0;n<_.keys(e.data).length;n++){var r=_.keys(e.data)[n];if(e.data[r]&&(6===e.data[r].level||8===e.data[r].level||10===e.data[r].level))switch(a.allTankInfos[r]=e.data[r],e.data[r].level){case 6:a.allTankInfosTier6.push(r);break;case 8:a.allTankInfosTier8.push(r);break;case 10:a.allTankInfosTier10.push(r)}}for(var n=0;n<_.keys(a.clan.members).length;n++){var s=_.keys(a.clan.members)[n],t=a.allTanksByPlayerId[s];a.allTanksByPlayerId[s]=[],l.info("tanksByThisPlayer.length (before) : "+t.length);for(var o=0;o<t.length;o++){var r=t[o].tank_id,i=a.allTankInfos[r];r&&i&&(6===i.level||8===i.level||10===i.level)&&(void 0===a.playersByTankId[r]&&(a.playersByTankId[r]=[]),void 0===a.playerNamesByTankId[r]&&(a.playerNamesByTankId[r]=[]),a.playersByTankId[r].push(s),a.playerNamesByTankId[r].push(a.clan.members[s].account_name),a.allTanksByPlayerId[s].push(r))}l.info("tanksByThisPlayer.length (after) : "+a.allTanksByPlayerId[s].length)}l.info("start"),$('#tabtiers a[role="tab"]:first').click(),setTimeout(function(){l.info("sort allTanksByPlayerId"),$("ul.list-tier").each(function(){var a=$(this),l=a.children("li");l.detach().sort(function(a,l){return $(l).data("sortby")-$(a).data("sortby")}),a.append(l)}),$("ul.list-clan-members").each(function(){var a=$(this),l=a.children("li");l.detach().sort(function(a,l){return $(l).data("sortby")-$(a).data("sortby")}),a.append(l)}),$(".tank-img").popover()},1e3)};a.showTanksByPlayerId=function(e){l.info("showing only tanks from "+e),a.currentPlayer=e,$(".list-clan-members li").removeClass("active"),$(".list-clan-members li[data-id="+e+"]").addClass("active"),a.allTankInfosTier6=[],a.allTankInfosTier8=[],a.allTankInfosTier10=[];for(var n=0;n<a.allTanksByPlayerId[e].length;n++){var r=a.allTanksByPlayerId[e][n];if(null===e)switch(a.allTankInfos[r].level){case 6:a.allTankInfosTier6.push(r);break;case 8:a.allTankInfosTier8.push(r);break;case 10:a.allTankInfosTier10.push(r)}else{var s=a.allTankInfos[r];if(s&&(6===s.level||8===s.level||10===s.level))switch(a.allTankInfos[r].level){case 6:a.allTankInfosTier6.push(r);break;case 8:a.allTankInfosTier8.push(r);break;case 10:a.allTankInfosTier10.push(r)}}}},n.getClan(r).then(o,t),a.tabModel=null,a.clan={},a.allTanksByPlayerId=[],a.allTanksByPlayerId2=[],a.allTankInfos=[],a.allTankInfosTier6=[],a.allTankInfosTier8=[],a.allTankInfosTier10=[],a.playersByTankId=[],a.playerNamesByTankId=[],a.players=[],a.playersList=[],a.currentPlayer=null,a.year=(new Date).getFullYear(),$('#tabtiers a[role="tab"]').on("click",function(a){a.preventDefault(),$(this).tab("show")})};a.controller("MainController",["$scope","$log","$location","wotSearch",l])}();